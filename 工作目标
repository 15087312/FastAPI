项目目标（Inventory Microservice）

核心目标：
构建一个专业的、生产级的库存微服务，能够在多平台、高并发环境下安全管理库存，防止超卖，支持微服务化架构。

功能目标：

库存管理核心功能

查询库存

扣减库存（reserve）

确认库存（confirm）

释放库存（release）

幂等操作，避免重复扣减

事务与锁

使用 PostgreSQL 行级锁（.with_for_update()）保证库存原子操作

按 product_id 顺序加锁避免死锁

库存字段加 CheckConstraint 避免负库存

微服务化设计

独立 API 层（FastAPI）

Service 层封装业务逻辑

可与 Order Service / Admin Service 对接

幂等与缓存

Redis 用于幂等控制

避免重复请求导致的库存问题

可扩展性

预留版本号字段以支持未来乐观锁切换

支持批量库存扣减

支持日志记录与追踪

二、预期交付与时间表
阶段	内容	目标交付
阶段 1：数据库准备	完整 SQLAlchemy Models、CheckConstraint、索引、软删除
阶段 2：Service 层实现	InventoryService，支持 reserve / confirm / release，事务 + 悲观锁	1~2 天
阶段 3：API 层实现	FastAPI 路由，输入校验，JSON 响应，Redis 幂等	1 天
阶段 4：测试与验证	单元测试 + 并发压力测试，确保无超卖、事务正确	1~2 天
阶段 5：文档与部署	README、启动脚本、Docker 化（可选）	0.5~1 天

总预期时间： 大约 4~6 天 可完成一个可上线微服务原型。